<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>RHS</title>
</head>
<body>

  <script type="text/javascript">

  //
  function foo () {
    console.log(a)
  }

  function bar () {
    var a = 3
    foo()
  }

  var a = 2

  bar()

  // 词法作用域让 foo() 中的a 通过RHS引用到全局作用域中的a，因此会输出2.

  // RHS: 需要获取哪个变量的值，就对哪个变量的值进行RHS引用，理解为赋值操作的源头。

  // 而动态作用域并不关心函数和作用域是如何声明以及在何处声明的，只关心它们从何处进行调用。换句话过，作用域链是基于调用栈的，而不是代码中的作用域嵌套。


  // 因此如果JavaScript具有动态作用域，理论上，下面代码中的 foo() 在执行时将输出3。
  // function foo () {
      // console.log(a) // 是3 （不是2！）
  // }
  // function bar () {
      // var a = 3
      // foo()
  // }
  // var a = 2
  // bar()



  // 为什么会这样？因为当foo()无法找到a的变量引用时，会顺着调用栈在调用foo的地方查找a，而不是在嵌套的词法作用域链中向上查找。由于foo是在bar中调用的，引擎会检查bar()的作用域，并在其中找到值为3的变量a。
  // 需要明确的是: 事实上JavaScript并不具有动态作用域。它只有词法作用域，简单明了。但是this机制某种程度上很像动态作用域。



  // 词法作用域和动态作用域的区别：
    // 1: 词法作用域是在写代码或者说定义时确定的，而动态作用域是在运行时确定的。(this也是！)
    // 2: 词法作用域关注于函数在何处声明，而动态作用域关注函数从何处调用。

  // this关注函数如何调用，这表明了this机制和动态作用域之间的关系多么紧密。


  </script>

</body>
</html>
